name: Test actions
on:
  pull_request:

jobs:
    shopware-version-fallback:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout code
              uses: actions/checkout@v4
            - id: version
              uses: ./shopware-version
              with:
                fallback: ""
            - name: Check shopware-version is never empty 
              run: |
                SHOPWARE_VERSION="${{ steps.version.outputs.shopware-version }}"
                echo "shopware-version: '${SHOPWARE_VERSION}'"
                if [[ -z "${SHOPWARE_VERSION}" ]]; then
                    echo 'shopware-version should not be empty'
                    exit 1
                fi
    shopware-version:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout code
              uses: actions/checkout@v4
            - name: Test shopware-version
              env:
                REF: "${{ github.ref }}"
                BASE_REF: "${{ github.base_ref }}"
                HEAD_REF: "${{ github.head_ref }}"
                REPO: "${{ inputs.repo || 'shopware/shopware' }}"
                CURRENT_REPO: "${{ github.repository }}"
                FALLBACK: "${{ inputs.fallback || 'trunk' }}"
              run: |
                env


